<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Mirror images into your own registry and swap image references automatically."><meta name=author content="Enrico Stahn"><link rel=canonical href=https://estahn.github.io/k8s-image-swapper/configuration.html><link rel=icon href=assets/images/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-8.5.10"><title>Configuration - k8s-image-swapper</title><link rel=stylesheet href=assets/stylesheets/main.975780f9.min.css><link rel=stylesheet href=assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=None data-md-color-accent=None> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#configuration class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=index.html title=k8s-image-swapper class="md-header__button md-logo" aria-label=k8s-image-swapper data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> k8s-image-swapper </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Configuration </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/estahn/k8s-image-swapper title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> estahn/k8s-image-swapper </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=index.html title=k8s-image-swapper class="md-nav__button md-logo" aria-label=k8s-image-swapper data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> k8s-image-swapper </label> <div class=md-nav__source> <a href=https://github.com/estahn/k8s-image-swapper title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> estahn/k8s-image-swapper </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=index.html class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=getting-started.html class=md-nav__link> Getting started </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Configuration <span class="md-nav__icon md-icon"></span> </label> <a href=configuration.html class="md-nav__link md-nav__link--active"> Configuration </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#dry-run class=md-nav__link> Dry Run </a> </li> <li class=md-nav__item> <a href=#log-level-format class=md-nav__link> Log Level &amp; Format </a> </li> <li class=md-nav__item> <a href=#imageswappolicy class=md-nav__link> ImageSwapPolicy </a> </li> <li class=md-nav__item> <a href=#imagecopypolicy class=md-nav__link> ImageCopyPolicy </a> </li> <li class=md-nav__item> <a href=#source class=md-nav__link> Source </a> <nav class=md-nav aria-label=Source> <ul class=md-nav__list> <li class=md-nav__item> <a href=#filters class=md-nav__link> Filters </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#target class=md-nav__link> Target </a> <nav class=md-nav aria-label=Target> <ul class=md-nav__list> <li class=md-nav__item> <a href=#aws class=md-nav__link> AWS </a> <nav class=md-nav aria-label=AWS> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ecr-options class=md-nav__link> ECR Options </a> <nav class=md-nav aria-label="ECR Options"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tags class=md-nav__link> Tags </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=faq.html class=md-nav__link> FAQ </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#dry-run class=md-nav__link> Dry Run </a> </li> <li class=md-nav__item> <a href=#log-level-format class=md-nav__link> Log Level &amp; Format </a> </li> <li class=md-nav__item> <a href=#imageswappolicy class=md-nav__link> ImageSwapPolicy </a> </li> <li class=md-nav__item> <a href=#imagecopypolicy class=md-nav__link> ImageCopyPolicy </a> </li> <li class=md-nav__item> <a href=#source class=md-nav__link> Source </a> <nav class=md-nav aria-label=Source> <ul class=md-nav__list> <li class=md-nav__item> <a href=#filters class=md-nav__link> Filters </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#target class=md-nav__link> Target </a> <nav class=md-nav aria-label=Target> <ul class=md-nav__list> <li class=md-nav__item> <a href=#aws class=md-nav__link> AWS </a> <nav class=md-nav aria-label=AWS> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ecr-options class=md-nav__link> ECR Options </a> <nav class=md-nav aria-label="ECR Options"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tags class=md-nav__link> Tags </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/estahn/k8s-image-swapper/edit/master/docs/docs/configuration.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=configuration>Configuration<a class=headerlink href=#configuration title="Permanent link">&para;</a></h1> <p>The configuration is managed via the config file <code>.k8s-image-swapper.yaml</code>. Some options can be overriden via parameters, e.g. <code>--dry-run</code>.</p> <h2 id=dry-run>Dry Run<a class=headerlink href=#dry-run title="Permanent link">&para;</a></h2> <p>The option <code>dryRun</code> allows to run the webhook without executing the actions, e.g. repository creation, image download and manifest mutation.</p> <div class="admonition example"> <p class=admonition-title>Example</p> <div class=highlight><pre><span></span><code><span class=nt>dryRun</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class=w></span>
</code></pre></div> </div> <h2 id=log-level-format>Log Level &amp; Format<a class=headerlink href=#log-level-format title="Permanent link">&para;</a></h2> <p>The option <code>logLevel</code> &amp; <code>logFormat</code> allow to adjust the verbosity and format (e.g. <code>json</code>, <code>console</code>).</p> <div class="admonition example"> <p class=admonition-title>Example</p> <div class=highlight><pre><span></span><code><span class=nt>logLevel</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">debug</span><span class=w></span>
<span class=nt>logFormat</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">console</span><span class=w></span>
</code></pre></div> </div> <h2 id=imageswappolicy>ImageSwapPolicy<a class=headerlink href=#imageswappolicy title="Permanent link">&para;</a></h2> <p>The option <code>imageSwapPolicy</code> (default: <code>exists</code>) defines the mutation strategy used.</p> <ul> <li><code>always</code>: Will always swap the image regardless of the image existence in the target registry. This can result in pods ending in state ImagePullBack if images fail to be copied to the target registry.</li> <li><code>exists</code>: Only swaps the image if it exits in the target registry. This can result in pods pulling images from the source registry, e.g. the first pod pulls from source registry, subsequent pods pull from target registry.</li> </ul> <h2 id=imagecopypolicy>ImageCopyPolicy<a class=headerlink href=#imagecopypolicy title="Permanent link">&para;</a></h2> <p>The option <code>imageCopyPolicy</code> (default: <code>delayed</code>) defines the image copy strategy used.</p> <ul> <li><code>delayed</code>: Submits the copy job to a process queue and moves on.</li> <li><code>immediate</code>: Submits the copy job to a process queue and waits for it to finish (deadline 8s).</li> <li><code>force</code>: Attempts to immediately copy the image (deadline 8s).</li> </ul> <h2 id=source>Source<a class=headerlink href=#source title="Permanent link">&para;</a></h2> <p>This section configures details about the image source.</p> <h3 id=filters>Filters<a class=headerlink href=#filters title="Permanent link">&para;</a></h3> <p>Filters provide control over what pods will be processed. By default, all pods will be processed. If a condition matches, the pod will <strong>NOT</strong> be processed.</p> <p><a href=https://jmespath.org/ >JMESPath</a> is used as query language and allows flexible rules for most use-cases.</p> <div class="admonition info"> <p class=admonition-title>Info</p> <p>The data structure used for JMESPath is as follows:</p> <div class=tabbed-set data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><label for=__tabbed_1_1>Structure</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=nt>obj</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class="l l-Scalar l-Scalar-Plain">&lt;Object Spec&gt;</span><span class=w></span>
<span class=nt>container</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class="l l-Scalar l-Scalar-Plain">&lt;Container Spec&gt;</span><span class=w></span>
</code></pre></div> </div> <input id=__tabbed_1_2 name=__tabbed_1 type=radio><label for=__tabbed_1_2>Example</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=nt>obj</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>metadata</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">static-web</span><span class=w></span>
<span class=w>    </span><span class=nt>labels</span><span class=p>:</span><span class=w></span>
<span class=w>      </span><span class=nt>role</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">myrole</span><span class=w></span>
<span class=w>  </span><span class=nt>spec</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>containers</span><span class=p>:</span><span class=w></span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">web</span><span class=w></span>
<span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span><span class=w></span>
<span class=w>        </span><span class=nt>ports</span><span class=p>:</span><span class=w></span>
<span class=w>          </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">web</span><span class=w></span>
<span class=w>            </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class=w></span>
<span class=w>            </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span><span class=w></span>
<span class=nt>container</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">web</span><span class=w></span>
<span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span><span class=w></span>
<span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">web</span><span class=w></span>
<span class=w>      </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class=w></span>
<span class=w>      </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span><span class=w></span>
</code></pre></div> </div> </div> </div> <p>Below you will find a list of common queries and/or ideas:</p> <div class="admonition tip"> <p class=admonition-title>List of common queries/ideas</p> <ul> <li>Do not process if namespace equals <code>kube-system</code> (<em>Helm chart default</em>) <div class=highlight><pre><span></span><code><span class=nt>source</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>filters</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>jmespath</span><span class=p>:</span><span class=w> </span><span class=s>&quot;obj.metadata.namespace</span><span class=nv> </span><span class=s>==</span><span class=nv> </span><span class=s>&#39;kube-system&#39;&quot;</span><span class=w></span>
</code></pre></div></li> <li>Only process if namespace equals <code>playground</code> <div class=highlight><pre><span></span><code><span class=nt>source</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>filters</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>jmespath</span><span class=p>:</span><span class=w> </span><span class=s>&quot;obj.metadata.namespace</span><span class=nv> </span><span class=s>!=</span><span class=nv> </span><span class=s>&#39;playground&#39;&quot;</span><span class=w></span>
</code></pre></div></li> <li>Only process if namespace ends with <code>-dev</code> <div class=highlight><pre><span></span><code><span class=nt>source</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>filters</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>jmespath</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ends_with(obj.metadata.namespace,&#39;-dev&#39;)&quot;</span><span class=w></span>
</code></pre></div></li> <li>Do not process AWS ECR images <div class=highlight><pre><span></span><code><span class=nt>source</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>filters</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>jmespath</span><span class=p>:</span><span class=w> </span><span class=s>&quot;contains(container.image,</span><span class=nv> </span><span class=s>&#39;.dkr.ecr.&#39;)</span><span class=nv> </span><span class=s>&amp;&amp;</span><span class=nv> </span><span class=s>contains(container.image,</span><span class=nv> </span><span class=s>&#39;.amazonaws.com&#39;)&quot;</span><span class=w></span>
</code></pre></div></li> </ul> </div> <p><code>k8s-image-swapper</code> will log the filter data and result in <code>debug</code> mode. This can be used in conjunction with <a href=https://jmespath.org/ >JMESPath.org</a> which has a live editor that can be used as a playground to experiment with more complex queries.</p> <h2 id=target>Target<a class=headerlink href=#target title="Permanent link">&para;</a></h2> <p>This section configures details about the image target.</p> <h3 id=aws>AWS<a class=headerlink href=#aws title="Permanent link">&para;</a></h3> <p>The option <code>target.registry.aws</code> holds details about the target registry storing the images. The AWS Account ID and Region is primarily used to construct the ECR domain <code>[ACCOUNTID].dkr.ecr.[REGION].amazonaws.com</code>.</p> <div class="admonition example"> <p class=admonition-title>Example</p> <div class=highlight><pre><span></span><code><span class=nt>target</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>aws</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>accountId</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">123456789</span><span class=w></span>
<span class=w>    </span><span class=nt>region</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ap-southeast-2</span><span class=w></span>
</code></pre></div> </div> <h4 id=ecr-options>ECR Options<a class=headerlink href=#ecr-options title="Permanent link">&para;</a></h4> <h5 id=tags>Tags<a class=headerlink href=#tags title="Permanent link">&para;</a></h5> <p>This provides a way to add custom tags to newly created repositories. This may be useful while looking at AWS costs. It's a slice of <code>Key</code> and <code>Value</code>.</p> <div class="admonition example"> <p class=admonition-title>Example</p> <div class=highlight><pre><span></span><code><span class=nt>target</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">aws</span><span class=w></span>
<span class=w>  </span><span class=nt>aws</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>ecrOptions</span><span class=p>:</span><span class=w></span>
<span class=w>      </span><span class=nt>tags</span><span class=p>:</span><span class=w></span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cluster</span><span class=w></span>
<span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">myCluster</span><span class=w></span>
</code></pre></div> </div> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=getting-started.html class="md-footer__link md-footer__link--prev" aria-label="Previous: Getting started" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Getting started </div> </div> </a> <a href=faq.html class="md-footer__link md-footer__link--next" aria-label="Next: FAQ" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> FAQ </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2020 Enrico Stahn </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": ".", "features": ["tabs"], "search": "assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=assets/javascripts/bundle.5a2dcb6a.min.js></script> </body> </html>